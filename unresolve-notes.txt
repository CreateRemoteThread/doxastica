/*
    unresolve(00401007) = "game.exe+7"
    new reference is returned (free the result when done)
*/
char *unresolve(UINT_PTR ptr)
{
    HMODULE hMods[1024];
	DWORD cbNeeded = 0;
	MODULEINFO modInfo;
	if( EnumProcessModules( hProcess, hMods, sizeof(hMods),&cbNeeded) )
	{
		int i = 0;
		for (; i < (cbNeeded / sizeof(HMODULE)); i++)
		{
			char szModName[1024];
			GetModuleInformation(hProcess,hMods[i],&modInfo,sizeof(modInfo));
			if(GetModuleFileNameEx( hProcess,hMods[i],szModName,sizeof(szModName) / sizeof(char)) )
			{
				if ( GetModuleInformation(hProcess,hMods[i],&modInfo,sizeof(modInfo)) )
				{
					sprintf(mbuf," + %s (0x%08x) (EP:0x%0x)\n",shortName(szModName),hMods[i],modInfo.EntryPoint);
					outString(hPipe,mbuf);
				}
				else
				{
					sprintf(mbuf," + %s (0x%08x)\n",shortName(szModName),hMods[i]);
					outString(hPipe,mbuf);
				}
			}
		}
	}
}
